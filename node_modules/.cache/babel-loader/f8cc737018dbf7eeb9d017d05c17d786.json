{"ast":null,"code":"import _classCallCheck from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\viz\\\\visualyticsFrontend\\\\src\\\\views\\\\Tables.js\";\nimport React from \"react\";\nimport { Container, Row, Col, Card, CardHeader, CardBody } from \"shards-react\";\n\nvar Tables = /*#__PURE__*/function (_React$Component) {\n  _inherits(Tables, _React$Component);\n\n  function Tables() {\n    _classCallCheck(this, Tables);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Tables).apply(this, arguments));\n  }\n\n  _createClass(Tables, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      activity_codes = {\n        \"1\": \" ROI 1\",\n        \"2\": \" ROI 2\",\n        \"3\": \"ROI 3\",\n        \"4\": \"ROI 4\",\n        \"5\": \"ROI 5\",\n        \"6\": \"ROI 6\",\n        \"7\": \"ROI 7\",\n        \"8\": \"ROI 8\",\n        \"9\": \"ROI 9\",\n        \"10\": \"ROI 10\",\n        \"11\": \"ROI 11\",\n        \"12\": \"ROI 12\",\n        \"13\": \"ROI 13\",\n        \"14\": \"ROI 14\",\n        \"15\": \"ROI 15\",\n        \"16\": \"ROI 16\",\n        \"17\": \"ROI 17\",\n        \"18\": \"ROI 18\",\n        \"19\": \"ROI 19\",\n        \"20\": \"ROI 20\",\n        \"21\": \"ROI 21\",\n        \"22\": \"ROI 22\"\n      };\n\n      function create_visualization(id, activityDictionary) {\n        radians = 0.0174532925, vizRadius = 350, margin = 100, width = (vizRadius + margin) * 2, height = (vizRadius + margin) * 2, activityCodes = Object.keys(activityDictionary);\n        numCategories = activityCodes.length;\n        var codesScale = d3.scaleLinear().range([0, 360]).domain([0, numCategories - 1]);\n        fociGroups = {};\n\n        for (i = 0; i < numCategories; i++) {\n          fociGroups[activityCodes[i]] = {};\n\n          if (i == 0) {\n            fociGroups[activityCodes[i]]['x'] = 0;\n            fociGroups[activityCodes[i]]['y'] = 0;\n          } else {\n            fociGroups[activityCodes[i]]['x'] = (vizRadius - 80) * Math.sin(codesScale(i - 1) * radians);\n            fociGroups[activityCodes[i]]['y'] = -(vizRadius - 80) * Math.cos(codesScale(i - 1) * radians);\n          }\n        }\n\n        svg = d3.select(\"#\" + id).append(\"svg\").attr(\"width\", width).attr(\"height\", height);\n        vizGroup = svg.append(\"g\").attr(\"id\", \"viz-area\").attr(\"transform\", \"translate(\".concat(vizRadius + margin, \",\").concat(vizRadius + margin, \")\"));\n        vizGroup.selectAll('.second-label').data(activityCodes).enter().append('text').attr('class', \"second-label\").attr('text-anchor', 'middle').attr('x', function (d, i) {\n          if (i == 0) {\n            return 0;\n          }\n\n          return vizRadius * Math.sin(codesScale(i - 1) * radians);\n        }).attr('y', function (d, i) {\n          if (i == 0) {\n            return 0;\n          }\n\n          return -vizRadius * Math.cos(codesScale(i - 1) * radians);\n        }).attr('z', 100).html(function (d, i) {\n          if (i == 0) {\n            return \"<tspan x=\\\"0\\\" y=\\\"0\\\"  z=\\\"100\\\">\".concat(activityDictionary[d], \"</tspan>\\n                          <tspan class=\\\"\").concat(\"perc\" + activityCodes[i], \"\\\" x=\\\"0\\\" y=\\\"0\\\", dy=\\\"1.5em\\\" \\\">\").concat(i, \"%</tspan>\");\n          }\n\n          return \"<tspan x=\\\"\".concat(vizRadius * Math.sin(codesScale(i - 1) * radians), \"\\\" y=\\\"\").concat(-vizRadius * Math.cos(codesScale(i - 1) * radians), \"\\\"  z=\\\"100\\\">\").concat(activityDictionary[d], \"</tspan>\\n                          <tspan class=\\\"\").concat(\"perc\" + activityCodes[i], \"\\\" x=\\\"\").concat(vizRadius * Math.sin(codesScale(i - 1) * radians), \"\\\" y=\\\"\").concat(-vizRadius * Math.cos(codesScale(i - 1) * radians), \"\\\" dy=1em  z=\\\"100\\\" >\").concat(i, \"%</tspan>\");\n        }); // for(i=0;i<numCategories;i++){\n        //     vizGroup.append('circle').\n        //         attr('cx',fociGroups[activityCodes[i]]['x']).\n        //         attr('cy',fociGroups[activityCodes[i]]['y']).\n        //         attr('r',10)\n        // }\n        // force animation code\n\n        function color(id) {\n          if (id == 50) {\n            id = 19;\n          }\n\n          val = id / 19;\n          return d3.interpolateRainbow(val);\n        }\n\n        var node = vizGroup.selectAll(\".people\").data(processed_data_arr, function (d) {\n          return d.key;\n        }).enter().append(\"circle\").attr(\"r\", 3).attr(\"fill\", function (d) {\n          return color(+d['activity'][d.current_activity].activity_code);\n        });\n        var forceX = d3.forceX(function (d) {\n          return fociGroups[d['activity'][d.current_activity].activity_code].x;\n        }); //fociGroups[d['activity'][d.current_activity].activity_code].x);\n\n        var forceY = d3.forceY(function (d) {\n          return fociGroups[d['activity'][d.current_activity].activity_code].y;\n        });\n        var force = d3.forceSimulation(processed_data_arr).velocityDecay(0.65).force('x', forceX).force('y', forceY).force(\"collide\", d3.forceCollide(3));\n        force.nodes(processed_data_arr).on('tick', function () {\n          node.attr('transform', function (d) {\n            return 'translate(' + d.x + ',' + d.y + ')';\n          });\n        });\n\n        function pad(d) {\n          return d < 10 ? '0' + d.toString() : d.toString();\n        }\n\n        d3.interval(function () {\n          time = (time + 1) % 60;\n          hour = Math.floor(time / 60);\n          minutes = time - hour * 60;\n\n          if (hour > 12 && hour < 24) {\n            hour = hour - 12;\n            d3.select(\"#time\").text(pad(hour) + \":\" + pad(minutes) + \" a.m.\");\n          } else {\n            hour = hour % 24;\n            d3.select(\"#time\").text(pad(hour) + \":\" + pad(minutes) + \" p.m.\");\n          }\n\n          percentage_counts = {};\n          processed_data_arr.forEach(function (d) {\n            if (time == 20) {\n              d.current_activity = 1;\n            } else if (d.current_activity == 0) {//le\n            } else if (+d['activity'][d.current_activity][\"stop\"] < time) {\n              d.current_activity = (d.current_activity + 1) % d.activity.length;\n\n              if (d.current_activity == 0) {\n                console.log(1);\n              }\n            } //count percentage of each activity\n\n\n            if (percentage_counts[d['activity'][d.current_activity].activity_code] == undefined) {\n              percentage_counts[d['activity'][d.current_activity].activity_code] = 1;\n            } else {\n              percentage_counts[d['activity'][d.current_activity].activity_code] += 1;\n            }\n          });\n\n          for (var i = 0; i < activityCodes.length; i++) {\n            val = percentage_counts[activityCodes[i]];\n\n            if (val == undefined) {\n              val = 0;\n            }\n\n            val = val / 10;\n            val = Math.floor(val * 100) / 100;\n            d3.select(\".perc\" + activityCodes[i]).text(val + \"%\");\n          }\n\n          node.transition().duration(0).attr(\"fill\", function (d) {\n            return color(d['activity'][d.current_activity].activity_code);\n          });\n          force.nodes(processed_data_arr);\n          force.alpha(0.8).restart();\n        }, 100);\n        vizGroup.selectAll('.second-label').raise();\n      }\n\n      time = 1;\n      processed_data = {};\n      d3.csv('main/journey.csv', function (data) {\n        if (processed_data[data[\"TUCASEID\"]] === undefined) {\n          processed_data[data[\"TUCASEID\"]] = {};\n          processed_data[data[\"TUCASEID\"]][\"activity\"] = [{\n            \"start\": 20,\n            \"stop\": 20,\n            \"activity_code\": 0\n          }];\n          processed_data[data[\"TUCASEID\"]][\"current_activity\"] = 1;\n        }\n\n        activity_id = data[\"TUACTIVITY_N\"].toString();\n        processed_data[data[\"TUCASEID\"]][\"activity\"][activity_id] = {\n          \"start\": data[\"start_minute\"],\n          \"stop\": data[\"stop_minute\"],\n          \"activity_code\": data[\"TUTIER1CODE\"]\n        };\n      }).then(start);\n\n      function start() {\n        processed_data_arr = [];\n        keys = Object.keys(processed_data);\n\n        for (var i = 0; i < keys.length; i++) {\n          dat = processed_data[keys[i]];\n          dat[\"key\"] = keys[i];\n          processed_data_arr.push(dat);\n        }\n\n        create_visualization(\"Visualization\", activity_codes);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(Container, {\n        fluid: true,\n        className: \"main-content-container px-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        noGutters: true,\n        className: \"page-header py-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 9\n        }\n      }, \"owais\")));\n    }\n  }]);\n\n  return Tables;\n}(React.Component);\n\nexport default Tables;","map":{"version":3,"sources":["C:/viz/visualyticsFrontend/src/views/Tables.js"],"names":["React","Container","Row","Col","Card","CardHeader","CardBody","Tables","activity_codes","create_visualization","id","activityDictionary","radians","vizRadius","margin","width","height","activityCodes","Object","keys","numCategories","length","codesScale","d3","scaleLinear","range","domain","fociGroups","i","Math","sin","cos","svg","select","append","attr","vizGroup","selectAll","data","enter","d","html","color","val","interpolateRainbow","node","processed_data_arr","key","current_activity","activity_code","forceX","x","forceY","y","force","forceSimulation","velocityDecay","forceCollide","nodes","on","pad","toString","interval","time","hour","floor","minutes","text","percentage_counts","forEach","activity","console","log","undefined","transition","duration","alpha","restart","raise","processed_data","csv","activity_id","then","start","dat","push","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Container, Row, Col, Card, CardHeader, CardBody } from \"shards-react\";\r\n\r\n\r\nclass Tables extends React.Component {\r\n  componentDidMount(){\r\n    activity_codes = {\r\n      \"1\":\" ROI 1\",\r\n      \"2\":\" ROI 2\",\r\n      \"3\": \"ROI 3\",\r\n      \"4\": \"ROI 4\",\r\n      \"5\": \"ROI 5\",\r\n      \"6\": \"ROI 6\",\r\n      \"7\": \"ROI 7\",\r\n      \"8\": \"ROI 8\",\r\n      \"9\": \"ROI 9\",\r\n      \"10\" : \"ROI 10\",\r\n      \"11\": \"ROI 11\",\r\n      \"12\": \"ROI 12\",\r\n      \"13\": \"ROI 13\",\r\n      \"14\": \"ROI 14\",\r\n      \"15\": \"ROI 15\",\r\n      \"16\": \"ROI 16\",\r\n      \"17\": \"ROI 17\",\r\n      \"18\": \"ROI 18\",\r\n      \"19\": \"ROI 19\",\r\n      \"20\": \"ROI 20\",\r\n      \"21\": \"ROI 21\",\r\n      \"22\": \"ROI 22\"\r\n      }\r\n  \r\n  function create_visualization(id,activityDictionary) {\r\n      radians = 0.0174532925,\r\n      vizRadius = 350,\r\n      margin = 100,\r\n      width = (vizRadius+margin)*2 ,\r\n      height = (vizRadius+margin)*2,\r\n  \r\n      activityCodes = Object.keys(activityDictionary)\r\n      numCategories = activityCodes.length\r\n  \r\n  \r\n      var codesScale = d3.scaleLinear()\r\n      .range([0,360])\r\n      .domain([0,numCategories-1]);\r\n  \r\n      fociGroups = {}\r\n      for(i=0;i<numCategories;i++){\r\n          fociGroups[activityCodes[i]]={}\r\n          if(i==0){\r\n             fociGroups[activityCodes[i]]['x']=0\r\n             fociGroups[activityCodes[i]]['y']=0\r\n          }\r\n          else{\r\n              fociGroups[activityCodes[i]]['x']= (vizRadius-80)*Math.sin(codesScale(i-1)*radians);\r\n              fociGroups[activityCodes[i]]['y']= -(vizRadius-80)*Math.cos(codesScale(i-1)*radians);\r\n          }\r\n      }\r\n  \r\n      svg = d3.select(\"#\"+id).\r\n      append(\"svg\").\r\n      attr(\"width\",width).\r\n      attr(\"height\",height)\r\n      vizGroup = svg.append(\"g\").\r\n                  attr(\"id\",\"viz-area\").\r\n                  attr(\"transform\",`translate(${vizRadius+margin},${vizRadius+margin})`)\r\n  \r\n  \r\n      vizGroup.selectAll('.second-label')\r\n          .data(activityCodes)\r\n              .enter()\r\n              .append('text')\r\n              .attr('class',\"second-label\")\r\n              .attr('text-anchor','middle')\r\n              .attr('x',function(d,i){\r\n                  if(i==0){\r\n                      return 0;\r\n                  }\r\n                  return vizRadius*Math.sin(codesScale(i-1)*radians);\r\n              })\r\n              .attr('y',function(d,i){\r\n                  if(i==0){\r\n                      return 0;\r\n                  }\r\n                  return -vizRadius*Math.cos(codesScale(i-1)*radians) ;\r\n              })\r\n              .attr('z',100)\r\n              .html(function(d,i){\r\n                   if(i==0){\r\n                      return `<tspan x=\"0\" y=\"0\"  z=\"100\">${activityDictionary[d]}</tspan>\r\n                          <tspan class=\"${\"perc\"+activityCodes[i]}\" x=\"0\" y=\"0\", dy=\"1.5em\" \">${i}%</tspan>`;\r\n                  }\r\n                  return `<tspan x=\"${vizRadius*Math.sin(codesScale(i-1)*radians)}\" y=\"${-vizRadius*Math.cos(codesScale(i-1)*radians)}\"  z=\"100\">${activityDictionary[d]}</tspan>\r\n                          <tspan class=\"${\"perc\"+activityCodes[i]}\" x=\"${vizRadius*Math.sin(codesScale(i-1)*radians)}\" y=\"${-vizRadius*Math.cos(codesScale(i-1)*radians)}\" dy=1em  z=\"100\" >${i}%</tspan>`;\r\n              });\r\n  \r\n      // for(i=0;i<numCategories;i++){\r\n      //     vizGroup.append('circle').\r\n      //         attr('cx',fociGroups[activityCodes[i]]['x']).\r\n      //         attr('cy',fociGroups[activityCodes[i]]['y']).\r\n      //         attr('r',10)\r\n  \r\n      // }\r\n  \r\n  \r\n      // force animation code\r\n  \r\n  \r\n  \r\n      function color(id){\r\n          if(id==50){\r\n              id=19\r\n          }\r\n          val = id/19\r\n          return d3.interpolateRainbow(val);\r\n  \r\n      }\r\n  \r\n      var node = vizGroup\r\n              .selectAll(\".people\")\r\n              .data(processed_data_arr,d => d.key)\r\n              .enter().append(\"circle\")\r\n              .attr(\"r\", 3)\r\n              .attr(\"fill\", (d)=>color(+d['activity'][d.current_activity].activity_code));\r\n  \r\n      var forceX = d3.forceX((d) => fociGroups[d['activity'][d.current_activity].activity_code].x);//fociGroups[d['activity'][d.current_activity].activity_code].x);\r\n      var forceY = d3.forceY((d) => fociGroups[d['activity'][d.current_activity].activity_code].y);\r\n  \r\n      var force = d3.forceSimulation(processed_data_arr)\r\n      .velocityDecay(0.65)\r\n      .force('x', forceX)\r\n      .force('y', forceY)\r\n      .force(\"collide\", d3.forceCollide(3));\r\n  \r\n      force.nodes(processed_data_arr)\r\n      .on('tick', function() {\r\n           node\r\n              .attr('transform', (d) => {\r\n                  return 'translate(' + (d.x) + ',' + (d.y) + ')';\r\n              });\r\n          });\r\n  \r\n      function pad(d) {\r\n          return (d < 10) ? '0' + d.toString() : d.toString();\r\n      }\r\n  \r\n      d3.interval(function(){\r\n          time = (time+1)% 60\r\n          hour = Math.floor(time/60)\r\n  \r\n          minutes = time - hour*60\r\n          if(hour>12 && hour < 24){\r\n              hour = hour-12\r\n              d3.select(\"#time\").text(pad(hour)+\":\"+pad(minutes)+\" a.m.\" )\r\n          }\r\n          else{\r\n              hour = hour%24\r\n              d3.select(\"#time\").text(pad(hour)+\":\"+pad(minutes)+\" p.m.\" )\r\n  \r\n          }\r\n  \r\n          percentage_counts = {}\r\n          processed_data_arr.forEach(function(d){\r\n              if(time == 20){\r\n                  d.current_activity=1\r\n              }\r\n              else if(d.current_activity==0){\r\n                      //le\r\n              }\r\n              else if(+d['activity'][d.current_activity][\"stop\"] < time){\r\n                  d.current_activity = (d.current_activity+ 1)% d.activity.length\r\n                  if(d.current_activity==0){\r\n                      console.log(1)\r\n                  }\r\n              }\r\n  \r\n              //count percentage of each activity\r\n              if( percentage_counts[d['activity'][d.current_activity].activity_code] == undefined){\r\n                  percentage_counts[d['activity'][d.current_activity].activity_code]=1\r\n              }\r\n              else{\r\n                  percentage_counts[d['activity'][d.current_activity].activity_code] += 1\r\n              }\r\n  \r\n          })\r\n          for(var i =0;i<activityCodes.length;i++){\r\n                  val = percentage_counts[activityCodes[i]]\r\n                  if(val == undefined){\r\n                      val =0\r\n                  }\r\n                  val = val/10\r\n                  val = Math.floor(val*100)/100\r\n                  d3.select(\".perc\"+activityCodes[i]).text(val+\"%\")\r\n          }\r\n          node.transition().duration(0).attr(\"fill\", (d)=>color(d['activity'][d.current_activity].activity_code));\r\n          force.nodes(processed_data_arr);\r\n          force.alpha(0.8).restart();\r\n      },100)\r\n  \r\n  \r\n      vizGroup.selectAll('.second-label').raise()\r\n  }\r\n  \r\n  time = 1\r\n  \r\n  processed_data = {}\r\n  \r\n  d3.csv('main/journey.csv', function(data) {\r\n      if(processed_data[data[\"TUCASEID\"]] === undefined){\r\n          processed_data[data[\"TUCASEID\"]] = {}\r\n          processed_data[data[\"TUCASEID\"]][\"activity\"] = [{\r\n                                                                      \"start\": 20,\r\n                                                                      \"stop\": 20,\r\n                                                                      \"activity_code\": 0\r\n                                                                  }]\r\n          processed_data[data[\"TUCASEID\"]][\"current_activity\"] = 1\r\n      }\r\n      activity_id = data[\"TUACTIVITY_N\"].toString()\r\n      processed_data[data[\"TUCASEID\"]][\"activity\"][activity_id] = {\r\n                                                                      \"start\": data[\"start_minute\"],\r\n                                                                      \"stop\": data[\"stop_minute\"],\r\n                                                                      \"activity_code\": data[\"TUTIER1CODE\"]\r\n                                                                  }\r\n  \r\n  \r\n  }).then(start);\r\n  \r\n  \r\n  function start(){\r\n  processed_data_arr = []\r\n  \r\n  keys = Object.keys(processed_data)\r\n  for(var i=0;i<keys.length;i++){\r\n      dat = processed_data[keys[i]]\r\n      dat[\"key\"] = keys[i]\r\n      processed_data_arr.push(dat)\r\n  }\r\n  \r\n  \r\n  create_visualization(\"Visualization\",activity_codes)\r\n  }\r\n  \r\n  }\r\n  render(){\r\n    return(\r\n      \r\n      <Container fluid className=\"main-content-container px-4\">\r\n        <Row noGutters className=\"page-header py-4\">\r\n        <p>owais</p>\r\n        </Row>\r\n        </Container>\r\n    );\r\n  }\r\n} \r\n\r\nexport default Tables;"]},"metadata":{},"sourceType":"module"}