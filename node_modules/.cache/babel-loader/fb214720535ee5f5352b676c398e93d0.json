{"ast":null,"code":"import _classCallCheck from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\viz\\\\visualyticsFrontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\viz\\\\visualyticsFrontend\\\\src\\\\views\\\\Tables.js\";\nimport React from \"react\";\nimport { Container, Row, Col, Card, CardHeader, CardBody } from \"shards-react\"; // import ScriptTag from 'react-script-tag';\n\nimport * as d3 from \"d3\";\n\nvar Tables = /*#__PURE__*/function (_React$Component) {\n  _inherits(Tables, _React$Component);\n\n  function Tables() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Tables);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Tables)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.create_visualization = function (id, activityDictionary) {\n      var activity_codes = {\n        \"1\": \" ROI 1\",\n        \"2\": \" ROI 2\",\n        \"3\": \"ROI 3\",\n        \"4\": \"ROI 4\",\n        \"5\": \"ROI 5\",\n        \"6\": \"ROI 6\",\n        \"7\": \"ROI 7\",\n        \"8\": \"ROI 8\",\n        \"9\": \"ROI 9\",\n        \"10\": \"ROI 10\",\n        \"11\": \"ROI 11\",\n        \"12\": \"ROI 12\",\n        \"13\": \"ROI 13\",\n        \"14\": \"ROI 14\",\n        \"15\": \"ROI 15\",\n        \"16\": \"ROI 16\",\n        \"17\": \"ROI 17\",\n        \"18\": \"ROI 18\",\n        \"19\": \"ROI 19\",\n        \"20\": \"ROI 20\",\n        \"21\": \"ROI 21\",\n        \"22\": \"ROI 22\"\n      };\n      var radians = 0.0174532925;\n      var vizRadius = 350;\n      var margin = 100;\n      var width = (vizRadius + margin) * 2;\n      var height = (vizRadius + margin) * 2;\n      var activityCodes = Object.keys(activityDictionary);\n      var numCategories = activityCodes.length;\n      var codesScale = d3.scaleLinear().range([0, 360]).domain([0, numCategories - 1]);\n      var fociGroups = {};\n\n      for (var i = 0; i < numCategories; i++) {\n        fociGroups[activityCodes[i]] = {};\n\n        if (i == 0) {\n          fociGroups[activityCodes[i]]['x'] = 0;\n          fociGroups[activityCodes[i]]['y'] = 0;\n        } else {\n          fociGroups[activityCodes[i]]['x'] = (vizRadius - 80) * Math.sin(codesScale(i - 1) * radians);\n          fociGroups[activityCodes[i]]['y'] = -(vizRadius - 80) * Math.cos(codesScale(i - 1) * radians);\n        }\n      }\n\n      var svg = d3.select(\"#\" + id).append(\"svg\").attr(\"width\", width).attr(\"height\", height);\n      var vizGroup = svg.append(\"g\").attr(\"id\", \"viz-area\").attr(\"transform\", \"translate(\".concat(vizRadius + margin, \",\").concat(vizRadius + margin, \")\"));\n      vizGroup.selectAll('.second-label').data(activityCodes).enter().append('text').attr('class', \"second-label\").attr('text-anchor', 'middle').attr('x', function (d, i) {\n        if (i == 0) {\n          return 0;\n        }\n\n        return vizRadius * Math.sin(codesScale(i - 1) * radians);\n      }).attr('y', function (d, i) {\n        if (i == 0) {\n          return 0;\n        }\n\n        return -vizRadius * Math.cos(codesScale(i - 1) * radians);\n      }).attr('z', 100).html(function (d, i) {\n        if (i == 0) {\n          return \"<tspan x=\\\"0\\\" y=\\\"0\\\"  z=\\\"100\\\">\".concat(activityDictionary[d], \"</tspan>\\n                            <tspan class=\\\"\").concat(\"perc\" + activityCodes[i], \"\\\" x=\\\"0\\\" y=\\\"0\\\", dy=\\\"1.5em\\\" \\\">\").concat(i, \"%</tspan>\");\n        }\n\n        return \"<tspan x=\\\"\".concat(vizRadius * Math.sin(codesScale(i - 1) * radians), \"\\\" y=\\\"\").concat(-vizRadius * Math.cos(codesScale(i - 1) * radians), \"\\\"  z=\\\"100\\\">\").concat(activityDictionary[d], \"</tspan>\\n                            <tspan class=\\\"\").concat(\"perc\" + activityCodes[i], \"\\\" x=\\\"\").concat(vizRadius * Math.sin(codesScale(i - 1) * radians), \"\\\" y=\\\"\").concat(-vizRadius * Math.cos(codesScale(i - 1) * radians), \"\\\" dy=1em  z=\\\"100\\\" >\").concat(i, \"%</tspan>\");\n      }); // for(i=0;i<numCategories;i++){\n      //     vizGroup.append('circle').\n      //         attr('cx',fociGroups[activityCodes[i]]['x']).\n      //         attr('cy',fociGroups[activityCodes[i]]['y']).\n      //         attr('r',10)\n      // }\n      // force animation code\n\n      function color(id) {\n        if (id == 50) {\n          id = 19;\n        }\n\n        var val = id / 19;\n        return d3.interpolateRainbow(val);\n      }\n\n      var node = vizGroup.selectAll(\".people\").data(processed_data_arr, function (d) {\n        return d.key;\n      }).enter().append(\"circle\").attr(\"r\", 3).attr(\"fill\", function (d) {\n        return color(+d['activity'][d.current_activity].activity_code);\n      });\n      var forceX = d3.forceX(function (d) {\n        return fociGroups[d['activity'][d.current_activity].activity_code].x;\n      }); //fociGroups[d['activity'][d.current_activity].activity_code].x);\n\n      var forceY = d3.forceY(function (d) {\n        return fociGroups[d['activity'][d.current_activity].activity_code].y;\n      });\n      var force = d3.forceSimulation(processed_data_arr).velocityDecay(0.65).force('x', forceX).force('y', forceY).force(\"collide\", d3.forceCollide(3));\n      force.nodes(processed_data_arr).on('tick', function () {\n        node.attr('transform', function (d) {\n          return 'translate(' + d.x + ',' + d.y + ')';\n        });\n      });\n\n      function pad(d) {\n        return d < 10 ? '0' + d.toString() : d.toString();\n      }\n\n      d3.interval(function () {\n        time = (time + 1) % 60;\n        hour = Math.floor(time / 60);\n        minutes = time - hour * 60;\n\n        if (hour > 12 && hour < 24) {\n          hour = hour - 12;\n          d3.select(\"#time\").text(pad(hour) + \":\" + pad(minutes) + \" a.m.\");\n        } else {\n          hour = hour % 24;\n          d3.select(\"#time\").text(pad(hour) + \":\" + pad(minutes) + \" p.m.\");\n        }\n\n        percentage_counts = {};\n        processed_data_arr.forEach(function (d) {\n          if (time == 20) {\n            d.current_activity = 1;\n          } else if (d.current_activity == 0) {//le\n          } else if (+d['activity'][d.current_activity][\"stop\"] < time) {\n            d.current_activity = (d.current_activity + 1) % d.activity.length;\n\n            if (d.current_activity == 0) {\n              console.log(1);\n            }\n          } //count percentage of each activity\n\n\n          if (percentage_counts[d['activity'][d.current_activity].activity_code] == undefined) {\n            percentage_counts[d['activity'][d.current_activity].activity_code] = 1;\n          } else {\n            percentage_counts[d['activity'][d.current_activity].activity_code] += 1;\n          }\n        });\n\n        for (var i = 0; i < activityCodes.length; i++) {\n          val = percentage_counts[activityCodes[i]];\n\n          if (val == undefined) {\n            val = 0;\n          }\n\n          val = val / 10;\n          val = Math.floor(val * 100) / 100;\n          d3.select(\".perc\" + activityCodes[i]).text(val + \"%\");\n        }\n\n        node.transition().duration(0).attr(\"fill\", function (d) {\n          return color(d['activity'][d.current_activity].activity_code);\n        });\n        force.nodes(processed_data_arr);\n        force.alpha(0.8).restart();\n      }, 100);\n      vizGroup.selectAll('.second-label').raise();\n    };\n\n    return _this;\n  }\n\n  _createClass(Tables, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(Container, {\n        fluid: true,\n        className: \"main-content-container px-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        noGutters: true,\n        className: \"page-header py-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"title\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 9\n        }\n      }, \"USA demo\"), /*#__PURE__*/React.createElement(\"link\", {\n        href: \"https://fonts.googleapis.com/css?family=Orbitron\",\n        rel: \"stylesheet\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"link\", {\n        href: \"https://fonts.googleapis.com/css?family=Unlock\",\n        rel: \"stylesheet\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 9\n        }\n      }, \"The American way of life\"), /*#__PURE__*/React.createElement(\"script\", {\n        src: \"https://d3js.org/d3.v5.min.js\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"script\", {\n        type: \"text/javascript\",\n        src: \"http://localhost/html/main/usa_data.js\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 9\n        }\n      })));\n    }\n  }]);\n\n  return Tables;\n}(React.Component);\n\nexport default Tables;","map":{"version":3,"sources":["C:/viz/visualyticsFrontend/src/views/Tables.js"],"names":["React","Container","Row","Col","Card","CardHeader","CardBody","d3","Tables","create_visualization","id","activityDictionary","activity_codes","radians","vizRadius","margin","width","height","activityCodes","Object","keys","numCategories","length","codesScale","scaleLinear","range","domain","fociGroups","i","Math","sin","cos","svg","select","append","attr","vizGroup","selectAll","data","enter","d","html","color","val","interpolateRainbow","node","processed_data_arr","key","current_activity","activity_code","forceX","x","forceY","y","force","forceSimulation","velocityDecay","forceCollide","nodes","on","pad","toString","interval","time","hour","floor","minutes","text","percentage_counts","forEach","activity","console","log","undefined","transition","duration","alpha","restart","raise","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Container, Row, Col, Card, CardHeader, CardBody } from \"shards-react\";\r\n// import ScriptTag from 'react-script-tag';\r\nimport * as d3 from \"d3\";\r\n\r\n\r\nclass Tables extends React.Component {\r\n  // componentDidMount() {}\r\n    \r\n      create_visualization = (id,activityDictionary) => {\r\n        let activity_codes = {\r\n          \"1\":\" ROI 1\",\r\n          \"2\":\" ROI 2\",\r\n          \"3\": \"ROI 3\",\r\n          \"4\": \"ROI 4\",\r\n          \"5\": \"ROI 5\",\r\n          \"6\": \"ROI 6\",\r\n          \"7\": \"ROI 7\",\r\n          \"8\": \"ROI 8\",\r\n          \"9\": \"ROI 9\",\r\n          \"10\" : \"ROI 10\",\r\n          \"11\": \"ROI 11\",\r\n          \"12\": \"ROI 12\",\r\n          \"13\": \"ROI 13\",\r\n          \"14\": \"ROI 14\",\r\n          \"15\": \"ROI 15\",\r\n          \"16\": \"ROI 16\",\r\n          \"17\": \"ROI 17\",\r\n          \"18\": \"ROI 18\",\r\n          \"19\": \"ROI 19\",\r\n          \"20\": \"ROI 20\",\r\n          \"21\": \"ROI 21\",\r\n          \"22\": \"ROI 22\"\r\n          };\r\n\r\n        var radians = 0.0174532925;\r\n        var vizRadius = 350;\r\n        var margin = 100;\r\n        var width = (vizRadius+margin)*2 ;\r\n        var height = (vizRadius+margin)*2;\r\n    \r\n        var activityCodes = Object.keys(activityDictionary);\r\n        var numCategories = activityCodes.length;\r\n    \r\n    \r\n        var codesScale = d3.scaleLinear()\r\n        .range([0,360])\r\n        .domain([0,numCategories-1]);\r\n    \r\n        var fociGroups = {}\r\n        for(var i=0;i<numCategories;i++){\r\n            fociGroups[activityCodes[i]]={}\r\n            if(i==0){\r\n               fociGroups[activityCodes[i]]['x']=0\r\n               fociGroups[activityCodes[i]]['y']=0\r\n            }\r\n            else{\r\n                fociGroups[activityCodes[i]]['x']= (vizRadius-80)*Math.sin(codesScale(i-1)*radians);\r\n                fociGroups[activityCodes[i]]['y']= -(vizRadius-80)*Math.cos(codesScale(i-1)*radians);\r\n            }\r\n        }\r\n    \r\n        var svg = d3.select(\"#\"+id).\r\n        append(\"svg\").\r\n        attr(\"width\",width).\r\n        attr(\"height\",height)\r\n        var vizGroup = svg.append(\"g\").\r\n                    attr(\"id\",\"viz-area\").\r\n                    attr(\"transform\",`translate(${vizRadius+margin},${vizRadius+margin})`)\r\n    \r\n    \r\n        vizGroup.selectAll('.second-label')\r\n            .data(activityCodes)\r\n                .enter()\r\n                .append('text')\r\n                .attr('class',\"second-label\")\r\n                .attr('text-anchor','middle')\r\n                .attr('x',function(d,i){\r\n                    if(i==0){\r\n                        return 0;\r\n                    }\r\n                    return vizRadius*Math.sin(codesScale(i-1)*radians);\r\n                })\r\n                .attr('y',function(d,i){\r\n                    if(i==0){\r\n                        return 0;\r\n                    }\r\n                    return -vizRadius*Math.cos(codesScale(i-1)*radians) ;\r\n                })\r\n                .attr('z',100)\r\n                .html(function(d,i){\r\n                     if(i==0){\r\n                        return `<tspan x=\"0\" y=\"0\"  z=\"100\">${activityDictionary[d]}</tspan>\r\n                            <tspan class=\"${\"perc\"+activityCodes[i]}\" x=\"0\" y=\"0\", dy=\"1.5em\" \">${i}%</tspan>`;\r\n                    }\r\n                    return `<tspan x=\"${vizRadius*Math.sin(codesScale(i-1)*radians)}\" y=\"${-vizRadius*Math.cos(codesScale(i-1)*radians)}\"  z=\"100\">${activityDictionary[d]}</tspan>\r\n                            <tspan class=\"${\"perc\"+activityCodes[i]}\" x=\"${vizRadius*Math.sin(codesScale(i-1)*radians)}\" y=\"${-vizRadius*Math.cos(codesScale(i-1)*radians)}\" dy=1em  z=\"100\" >${i}%</tspan>`;\r\n                });\r\n    \r\n        // for(i=0;i<numCategories;i++){\r\n        //     vizGroup.append('circle').\r\n        //         attr('cx',fociGroups[activityCodes[i]]['x']).\r\n        //         attr('cy',fociGroups[activityCodes[i]]['y']).\r\n        //         attr('r',10)\r\n    \r\n        // }\r\n    \r\n    \r\n        // force animation code\r\n    \r\n    \r\n    \r\n        function color(id){\r\n            if(id==50){\r\n                id=19\r\n            }\r\n            var val = id/19\r\n            return d3.interpolateRainbow(val);\r\n    \r\n        }\r\n    \r\n        var node = vizGroup\r\n                .selectAll(\".people\")\r\n                .data(processed_data_arr,d => d.key)\r\n                .enter().append(\"circle\")\r\n                .attr(\"r\", 3)\r\n                .attr(\"fill\", (d)=>color(+d['activity'][d.current_activity].activity_code));\r\n    \r\n        var forceX = d3.forceX((d) => fociGroups[d['activity'][d.current_activity].activity_code].x);//fociGroups[d['activity'][d.current_activity].activity_code].x);\r\n        var forceY = d3.forceY((d) => fociGroups[d['activity'][d.current_activity].activity_code].y);\r\n    \r\n        var force = d3.forceSimulation(processed_data_arr)\r\n        .velocityDecay(0.65)\r\n        .force('x', forceX)\r\n        .force('y', forceY)\r\n        .force(\"collide\", d3.forceCollide(3));\r\n    \r\n        force.nodes(processed_data_arr)\r\n        .on('tick', function() {\r\n             node\r\n                .attr('transform', (d) => {\r\n                    return 'translate(' + (d.x) + ',' + (d.y) + ')';\r\n                });\r\n            });\r\n    \r\n        function pad(d) {\r\n            return (d < 10) ? '0' + d.toString() : d.toString();\r\n        }\r\n    \r\n        d3.interval(function(){\r\n            time = (time+1)% 60\r\n            hour = Math.floor(time/60)\r\n    \r\n            minutes = time - hour*60\r\n            if(hour>12 && hour < 24){\r\n                hour = hour-12\r\n                d3.select(\"#time\").text(pad(hour)+\":\"+pad(minutes)+\" a.m.\" )\r\n            }\r\n            else{\r\n                hour = hour%24\r\n                d3.select(\"#time\").text(pad(hour)+\":\"+pad(minutes)+\" p.m.\" )\r\n    \r\n            }\r\n    \r\n            percentage_counts = {}\r\n            processed_data_arr.forEach(function(d){\r\n                if(time == 20){\r\n                    d.current_activity=1\r\n                }\r\n                else if(d.current_activity==0){\r\n                        //le\r\n                }\r\n                else if(+d['activity'][d.current_activity][\"stop\"] < time){\r\n                    d.current_activity = (d.current_activity+ 1)% d.activity.length\r\n                    if(d.current_activity==0){\r\n                        console.log(1)\r\n                    }\r\n                }\r\n    \r\n                //count percentage of each activity\r\n                if( percentage_counts[d['activity'][d.current_activity].activity_code] == undefined){\r\n                    percentage_counts[d['activity'][d.current_activity].activity_code]=1\r\n                }\r\n                else{\r\n                    percentage_counts[d['activity'][d.current_activity].activity_code] += 1\r\n                }\r\n    \r\n            })\r\n            for(var i =0;i<activityCodes.length;i++){\r\n                    val = percentage_counts[activityCodes[i]]\r\n                    if(val == undefined){\r\n                        val =0\r\n                    }\r\n                    val = val/10\r\n                    val = Math.floor(val*100)/100\r\n                    d3.select(\".perc\"+activityCodes[i]).text(val+\"%\")\r\n            }\r\n            node.transition().duration(0).attr(\"fill\", (d)=>color(d['activity'][d.current_activity].activity_code));\r\n            force.nodes(processed_data_arr);\r\n            force.alpha(0.8).restart();\r\n        },100)\r\n    \r\n    \r\n        vizGroup.selectAll('.second-label').raise()\r\n    }\r\n\r\n\r\n  \r\n  render(){\r\n    return(\r\n      \r\n      <Container fluid className=\"main-content-container px-4\">\r\n        <Row noGutters className=\"page-header py-4\">\r\n        <title>USA demo</title>\r\n        <link href=\"https://fonts.googleapis.com/css?family=Orbitron\" rel=\"stylesheet\"></link>\r\n        <link href=\"https://fonts.googleapis.com/css?family=Unlock\" rel=\"stylesheet\"></link>\r\n        {/* <link rel=\"stylesheet\" type=\"text/css\" href=\"http://localhost/html/main/usa_data.css\"></link> */}\r\n        <div id=\"title\">The American way of life</div>\r\n        <script src=\"https://d3js.org/d3.v5.min.js\"></script>\r\n        <script type=\"text/javascript\" src=\"http://localhost/html/main/usa_data.js\"></script>\r\n        {/* <img src=\"http://localhost/html/main/a.png\" width=\"500\" alt=\"ROI Locations\" /> */}\r\n        </Row>\r\n        </Container>\r\n    );\r\n  }\r\n} \r\n\r\nexport default Tables;"]},"metadata":{},"sourceType":"module"}